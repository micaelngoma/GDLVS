<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GDLVS - Analytics Dashboard</title>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <!-- Charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- ðŸ”§ Load order for i18n (VERY IMPORTANT) -->
  <script src="https://unpkg.com/jquery@3.6.0/dist/jquery.min.js"></script>
  <script>window.$ = window.jQuery = window.$ || window.jQuery;</script>
  <script src="https://unpkg.com/i18next@21.6.3/dist/umd/i18next.min.js"></script>
  <script src="https://unpkg.com/i18next-browser-languagedetector@6.1.2/i18nextBrowserLanguageDetector.min.js"></script>
  <script src="https://unpkg.com/jquery-i18next@1.2.1/dist/umd/jquery-i18next.min.js"></script>

  <style>
    :root {
      --brand:#2a3f54; --brand2:#1e2d3c;
      --success:#27ae60; --danger:#e74c3c; --info:#2980b9; --warn:#f1c40f;
      --shadow:0 2px 8px rgba(0,0,0,.2);
    }

    body{
      margin:0;
      font-family:Arial, sans-serif;
      background:#f6f8fb;
      color:#333;
      min-height:100vh;
    }

    /* ===== Header ===== */
    header{
      background:rgba(42,63,84,0.9);
      color:#fff;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 16px;
      box-shadow:var(--shadow);
      backdrop-filter:blur(6px);
    }
    header h1{margin:0;font-size:18px;display:flex;align-items:center;gap:8px;}
    .header-controls{display:flex;gap:8px;}
    .mini-btn{
      background:var(--brand2);
      color:#fff;border:0;border-radius:8px;
      padding:6px 10px;cursor:pointer;
    }
    .mini-btn:hover{background:#16222d;}
    .mini-select{
      border:1px solid #ccc;border-radius:8px;
      padding:6px 8px;font-size:12px;background:#fff;
    }

    /* ===== Nav ===== */
    nav{
      background:rgba(255,255,255,0.85);
      border-bottom:1px solid #eaeaea;
      padding:10px 14px;
      display:flex;gap:14px;flex-wrap:wrap;
      backdrop-filter:blur(6px);
    }
    nav a{
      color:var(--brand);
      text-decoration:none;
      font-weight:700;
      transition:.2s;
    }
    nav a:hover{color:var(--brand2);}
    nav a.active{
      border-bottom:2px solid var(--brand);
      padding-bottom:4px;
    }

    /* ===== Containers ===== */
    .container{max-width:1200px;margin:20px auto;padding:0 14px;}
    h2,h3{color:var(--brand);}

    /* ===== Dashboard Cards ===== */
    .dashboard-cards{
      display:flex;gap:12px;justify-content:center;
      flex-wrap:wrap;margin:10px 0 20px;
    }
    .card{
      flex:1 1 200px;max-width:220px;min-width:160px;
      border-radius:12px;
      color:#fff;text-align:center;
      padding:16px;
      box-shadow:var(--shadow);
      font-weight:bold;
    }
    .card i{display:block;margin-bottom:6px;font-size:1.3rem;}
    .card.total{background:var(--info);}
    .card.active{background:var(--success);}
    .card.pending{background:var(--warn);}
    .card.danger{background:var(--danger);}
    .card h3{margin:8px 0 0;color:#fff;} /* âœ… White text ensured */

    /* ===== Panels & Tables ===== */
    section.panel{
      background:#fff;
      border-radius:10px;
      box-shadow:var(--shadow);
      padding:20px;margin-top:20px;
    }
    table{width:100%;border-collapse:separate;border-spacing:0 6px;margin-top:10px;}
    th,td{background:#fff;border:1px solid #eee;padding:10px 12px;text-align:left;}
    th{background:#f2f2f2;}
    canvas{max-width:100%;margin:20px auto;display:block;}

    /* ===== Light/Dark Mode ===== */
    @media (prefers-color-scheme: dark) {
      body{background:#1a1d22;color:#eaeaea;}
      header{background:rgba(30,45,60,0.9);color:#f1f1f1;}
      nav{background:rgba(40,55,70,0.7);color:#f1f1f1;}
      section.panel{background:rgba(255,255,255,0.07);color:#f0f0f0;}
      th,td{background:rgba(255,255,255,0.07);color:#fff;}
      .card h3{color:#fff;}
    }
  </style>
</head>
<body>
  <header>
    <h1><i class="fa-solid fa-chart-line"></i> <span data-i18n="analyticsTitle">GDLVS Analytics</span></h1>
    <div class="header-controls">
      <select id="languageSwitcher" class="mini-select" aria-label="Language">
        <option value="en">ðŸ‡¬ðŸ‡§ English</option>
        <option value="fr">ðŸ‡«ðŸ‡· FranÃ§ais</option>
        <option value="ja">ðŸ‡¯ðŸ‡µ æ—¥æœ¬èªž</option>
      </select>
      <button id="logoutBtn" class="mini-btn"><i class="fa-solid fa-right-from-bracket"></i> <span data-i18n="signOut">Sign Out</span></button>
    </div>
  </header>

  <nav>
    <a href="dashboard.html"><i class="fa-solid fa-house"></i> <span data-i18n="dashboard">Dashboard</span></a>
    <a href="verify.html"><i class="fa-solid fa-search"></i> <span data-i18n="verification">Verification</span></a>
    <a href="add_licenses.html"><i class="fa-solid fa-id-card"></i> <span data-i18n="addLicense">Add License</span></a>
    <a href="users.html"><i class="fa-solid fa-users"></i> <span data-i18n="users">Users</span></a>
    <a href="verification_requests.html"><i class="fa-solid fa-inbox"></i> <span data-i18n="requests">Access Requests</span></a>
    <a class="active" href="analytics.html"><i class="fa-solid fa-chart-bar"></i> <span data-i18n="analytics">Analytics</span></a>
  </nav>

  <main class="container">
    <h2><i class="fa-solid fa-database"></i> <span data-i18n="systemOverview">System Overview</span></h2>
    <div class="dashboard-cards">
      <div class="card total"><i class="fa-solid fa-id-card"></i><h3><span data-i18n="licenses">Licenses</span>: <span id="totalLicenses">0</span></h3></div>
      <div class="card active"><i class="fa-solid fa-magnifying-glass"></i><h3><span data-i18n="verifications">Verifications</span>: <span id="totalVerifications">0</span></h3></div>
      <div class="card pending"><i class="fa-solid fa-user-clock"></i><h3><span data-i18n="pendingUsers">Pending Users</span>: <span id="pendingUsers">0</span></h3></div>
      <div class="card danger"><i class="fa-solid fa-envelope"></i><h3><span data-i18n="pendingRequests">Pending Requests</span>: <span id="pendingRequests">0</span></h3></div>
      <div class="card total"><i class="fa-solid fa-globe"></i><h3><span data-i18n="countries">Countries</span>: <span id="countriesCount">0</span></h3></div>
    </div>

    <section class="panel">
      <h3><i class="fa-solid fa-chart-pie"></i> <span data-i18n="verificationPerformance">Verification Performance</span></h3>
      <canvas id="resultChart"></canvas>
    </section>

    <section class="panel">
      <h3><i class="fa-solid fa-chart-bar"></i> <span data-i18n="topCountries">Top Countries</span></h3>
      <canvas id="countryChart"></canvas>
    </section>

    <section class="panel">
      <h3><i class="fa-solid fa-clock-rotate-left"></i> <span data-i18n="recentVerifications">Recent Verifications</span></h3>
      <table>
        <thead>
          <tr>
            <th>License #</th><th>Organization</th><th>Country</th><th>Result</th><th>Date</th>
          </tr>
        </thead>
        <tbody id="verificationLogs"><tr><td colspan="5" data-i18n="loading">Loading...</td></tr></tbody>
      </table>
    </section>
  </main>

  <!-- Your existing Firebase + Analytics logic remains untouched -->
  <script type="module">
    /* ... (unchanged script from your version) ... */
  </script>
</body>
</html>
